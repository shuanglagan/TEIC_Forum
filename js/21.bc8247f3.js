(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{8464:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-ma-md"},[a("div",{staticClass:"row justify-around"},[a("q-btn",{staticClass:"col-md-auto col-2",attrs:{label:"建立新貼文",color:"primary"},on:{click:function(e){t.form.card=!0}}},[a("q-dialog",{attrs:{persistent:""},model:{value:t.form.card,callback:function(e){t.$set(t.form,"card",e)},expression:"form.card"}},[a("q-card",{staticStyle:{"min-width":"650px"}},[a("q-card-section",[a("div",{staticClass:"text-h6 text-bold"},[t._v("標題")]),a("q-input",{staticClass:"col-12",attrs:{filled:"",type:"text",label:"標題","label-for":"input-title",autofocus:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),a("q-card-section",[a("div",{staticClass:"text-h6 text-bold"},[t._v("內容")]),a("q-editor",{staticClass:"col-12",attrs:{filled:"",type:"textarea",label:"內容","label-for":"input-contents",hint:"請輸入說明",toolbar:[[{label:"標題",icon:t.$q.iconSet.editor.formatting,fixedLabel:!0,options:["p","h1","h2","h3","h4","h5","h6","code"]}],[{label:"段落",icon:t.$q.iconSet.editor.align,fixedLabel:!0,options:["quote","unordered","ordered","outdent","indent","left","center","right","justify"]}],[{label:"字體",icon:t.$q.iconSet.editor.font,fixedLabel:!0,options:["bold","italic","strike","underline","subscript","superscript"]}],[{label:"字型",fixedLabel:!0,options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["token","hr","link","custom_btn"],["undo","redo"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},model:{value:t.form.contents,callback:function(e){t.$set(t.form,"contents",e)},expression:"form.contents"}})],1),a("q-card-section",[a("div",{staticClass:"text-h6 text-bold"},[t._v("附加圖片")]),a("img-inputer",{staticClass:"col-12 justify-center",staticStyle:{height:"200px width:100%"},attrs:{theme:"dark",size:"large",placeholder:"點擊或拖曳選擇圖片","bottom-text":"點擊或拖曳以修改"},model:{value:t.form.image,callback:function(e){t.$set(t.form,"image",e)},expression:"form.image"}}),a("br")],1),a("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[a("q-btn",{staticClass:"q-ml-sm col-2",attrs:{label:"送出",type:"submit",color:"primary"}}),a("q-btn",{staticClass:"q-ml-sm col-2",attrs:{label:"重設",type:"reset",color:"primary"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm col-2",attrs:{flat:"",label:"取消",color:"primary"}})],1)],1)],1)],1)],1)])},o=[],i=a("c973"),n=a.n(i),s=(a("96cf"),a("99af"),a("d81d"),{data:function(){return{posts:[],form:{card:!1,title:"",contents:"",image:null,_id:""}}},computed:{rules:function(){var t=this.form.title,e=this.form.contents;return{title:0===t.length?null:t.length>=0,contents:0===e.length?null:e.length>=0}}},methods:{reset:function(){this.form.title="",this.form.contents="",this.form.image=""},editPost:function(t){this.form={title:this.posts[t].title,contents:this.posts[t].contents,image:this.posts[t].image,_id:this.posts[t]._id,index:t}},submit:function(){var t=this;return n()(regeneratorRuntime.mark((function e(){var a,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r in e.prev=0,a=new FormData,t.form)a.append(r,t.form[r]);if(0!==t.form._id.length){e.next=8;break}return e.next=6,t.axios.post("/posts",a,{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 6:e.next=13;break;case 8:return e.next=10,t.axios.patch("/posts/"+t.form._id,a,{headers:{authorization:"Bearer "+t.$store.state.jwt.token}});case 10:o=e.sent,i=o.data,t.posts[t.form.index]={title:t.form.title,contents:t.form.contents,image:"".concat("https://tiec-forum.herokuapp.com","/files/").concat(i.result.image),_id:t.form._id};case 13:e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤"}),console.log(e.t0);case 19:t.submitDisable=!1;case 20:case"end":return e.stop()}}),e,null,[[0,15]])})))()}},mounted:function(){var t=this;return n()(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.axios.get("/posts");case 3:a=e.sent,r=a.data,t.posts=r.result.map((function(t){return t.image&&(t.image="".concat("https://tiec-forum.herokuapp.com","/files/").concat(t.image)),t})),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"錯誤",text:"取得商品失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}),c=s,l=a("2877"),m=a("9c40"),d=a("24e8"),u=a("0378"),p=a("f09f"),f=a("a370"),h=a("27f9"),b=a("d66b"),x=a("4b7e"),g=a("7f67"),v=a("eebe"),w=a.n(v),_=Object(l["a"])(c,r,o,!1,null,null,null);e["default"]=_.exports;w()(_,"components",{QBtn:m["a"],QDialog:d["a"],QForm:u["a"],QCard:p["a"],QCardSection:f["a"],QInput:h["a"],QEditor:b["a"],QCardActions:x["a"]}),w()(_,"directives",{ClosePopup:g["a"]})}}]);